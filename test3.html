<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>test3</title>
    <style>
      table {
        border-collapse: collapse;
      }

      tr {
        border: 1px solid red;
      }
      tr:hover {
        background-color: tomato;
      }
    </style>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script src="https://code.jquery.com/ui/1.11.2/jquery-ui.js"></script>
  </head>
  <body>
    <table>
      <tbody>
        <!-- <tr draggable="true" class="drag target">
          <td>1</td>
          <td>2</td>
          <td>3</td>
          <td>4</td>
          <td>5</td>
        </tr>
        <tr draggable="true" class="drag target">
          <td>11</td>
          <td>22</td>
          <td>33</td>
          <td>44</td>
          <td>55</td>
        </tr>
        <tr draggable="true" class="drag target">
          <td>111</td>
          <td>222</td>
          <td>333</td>
          <td>444</td>
          <td>555</td>
        </tr> -->
      </tbody>
    </table>

    <script>
      // 用迴圈跑出dom結構
      const arr = [
        [1, 2, 3, 4, 5],
        [11, 22, 33, 44, 55],
        [111, 222, 333, 444, 555],
      ];
      const tbody = document.querySelector("tbody");
      arr.map((v1, i1) => {
        let trtdStr = `<tr draggable="true" data-type=${i1} class="drag target">`;
        v1.map((v2, i2) => {
          trtdStr += `<td>${v2}</td>`;
        });
        trtdStr += "</tr>";
        tbody.innerHTML += trtdStr;
      });

      const drags = document.querySelectorAll(".drag");
      const target = document.querySelectorAll(".target");
      let dragDom = null;

      [...drags].map((v, i) => {
        v.addEventListener("dragstart", dragstart);
        v.addEventListener("dragend", dragend);
      });
      function dragstart(e) {
        console.log("dragstart");
        dragDom = this;
      }

      function dragend(e) {
        console.log("dragend");
      }

      [...target].map((v, i) => {
        v.addEventListener("dragenter", dragenter);

        v.addEventListener("dragover", dragover);

        v.addEventListener("dragleave", dragleave);

        v.addEventListener("drop", drop);
      });

      function dragenter(e) {
        e.preventDefault();
        console.log("dragenter");
      }

      function dragover(e) {
        e.preventDefault();
        console.log("dragover");
      }

      function dragleave(e) {
        e.preventDefault();
        console.log("dragleave");
      }

      function drop(e) {
        e.preventDefault();
        console.log("drop");
        // 暫時只做的到新增進去，但要指定位置
        // this.parentNode.appendChild(dragDom);
        console.log(this);
        console.log(this.dataset.type);
        console.log(dragDom.dataset.type);
        arr.splice(this.dataset.type, 1, arr[dragDom.dataset.type]);
      }
    </script>
  </body>
</html>
